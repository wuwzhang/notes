{"_id":"note:wo-nYiq21","title":"app-shell","content":"## 什么是`App Shell`\n在页面切换时页面上固定不动的内容就是`App Shell`的一部分\n\n`App Shell`就是外壳部分，即页面的基本结构，如下图所示：\n![](https://lavas-project.github.io/pwa-book/chapter02/img/appshell.png)\n\n## 正确使用`App Shell`\n难点\n- 难以确定合适的`HTTP`缓存设置时间，也不适合更新比较频繁的站点\n- `HTTP`缓存只有在`URL`相等的情况下才能起作用，这不符合`PWA`每个页面有唯一 URL 的要求\n\n可以结合`App Shell`和`Service Worker`来解决缓存问题\n1. 使用`Service Worker`预缓存`App Shell`的静态资源\n2. 用户访问`Web`站点时，通过`Service Worker`拦截请求\n3. `Service Worker`返回缓存中的`App Shell`给浏览器\n4. `App Shell`根据当前的`URL`再去请求对应的数据来渲染\n\n`App Shell`和`Service Worker`结合使用的收益\n- 第二次访问速度极快且稳定。由于`App Shell`的内容已经缓存在本地缓存中，用户第二次访问会在极短的时间内渲染出`App Shell`\n- 为用户节省流量。用户在后续的访问都不会再请求`App Shell`的内容，而是只请求主体内容，不用加载一些公用的静态文件。\n- 具有`Native App`的用户体验。无论是第一次访问还是后续页面的切换，都具有唯一不变的区域，没有传统`Web`页面切换的白屏。","tags":[],"folderPathname":"/font/pwa","data":{},"createdAt":"2021-03-31T01:52:28.354Z","updatedAt":"2021-03-31T02:05:33.565Z","trashed":false,"_rev":"7NWeislPO"}