{"title":"前端微服务","content":"前端微服务\n==\n\n> 微前端是一种多个团队通过独立发布功能的方式来共同构建现代化`web`应用的技术手段及方法策略\n\n## 什么是微前端\n微前端架构具备以下几个核心价值：\n\n- 技术栈无关\n  - 主框架不限制接入应用的技术栈，微应用具备完全自主权\n- 独立开发、独立部署\n  - 微应用仓库独立，前后端可独立开发，部署完成后主框架自动完成同步更新\n- 增量升级\n  - 在面对各种复杂场景时，我们通常很难对一个已经存在的系统做全量的技术栈升级或重构，而微前端是一种非常好的实施渐进式重构的手段和策略\n- 独立运行时\n  - 每个微应用之间状态隔离，运行时状态不共享\n\n微前端架构旨在解决单体应用在一个相对长的时间跨度下，由于参与的人员、团队的增多、变迁，从一个普通应用演变成一个巨石应用([Frontend Monolith](https://www.youtube.com/watch?v=pU1gXA0rfwc))后，随之而来的应用不可维护的问题。这类问题在企业级`Web`应用中尤其常见\n\n\n`MPA`方案的优点在于 部署简单、各应用之间硬隔离，天生具备技术栈无关、独立开发、独立部署的特性。缺点则也很明显，应用之间切换会造成浏览器重刷，由于产品域名之间相互跳转，流程体验上会存在断点。\n\n`SPA`则天生具备体验上的优势，应用直接无刷新切换，能极大的保证多产品之间流程操作串联时的流程性。缺点则在于各应用技术栈之间是强耦合的。\n\n微前端架构的优势，正是`MPA`与`SPA`架构优势的合集。即保证应用具备独立开发权的同时，又有将它们整合到一起保证产品完整的流程体验的能力\n\n## 技术选型\n### `single-spa`\n- 将每一个子应用打包成独立的`js`文件，通过`registerApplication`接口来约定子应用与主框架间的交互行为\n- 生命周期，用来做初始化和垃圾收集操作\n- 子应用技术栈无关、独立开发、独立部署\n- 不足\n  - `js`包体积大，无法并行加载\n  - 全局变量、监听污染、样式污染\n### `qiankun`\n> 在 single-spa 的基础上增加了通过 html 加载子应用，子应用样式、js 运行环境隔离等特性\n\n- `html entry`\n  - 应用静态资源表\n## 为什么不使用`Iframe`\n- 状态丢失\n  - `url`刷新，`iframe` `url`状态丢失，前进后退无法使用\n- `DOM`不共享\n  - 无法实现`iframe`中的弹窗在指定位置\n  - 浏览器`resize`\n- 上下文隔离\n  - 内存变量不共享，主应用的`token`传递到子应用中避免重复登录\n- 加载慢","tags":[],"folderPathname":"/font","data":{},"createdAt":"2020-08-07T02:54:21.288Z","updatedAt":"2021-03-17T07:22:37.389Z","trashed":false,"_id":"note:UN-JE8m_u","_rev":"pdPsxCa9E"}