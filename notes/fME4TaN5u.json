{"_id":"note:fME4TaN5u","title":"Web Components ","content":"## [Web Components 上手指南](https://mp.weixin.qq.com/s/dfPBhp8atU5QSCv55QJQfA)\n现在的前端开发基本离不开`React`、`Vue`这两个框架的支撑，而这两个框架下面又衍生出了许多的自定义组件库：\n- `Element（Vue）`\n- `Ant Design（React）`\n\n这些组件库的出现，让我们可以直接使用已经封装好的组件，而且在开源社区的帮助下，出现了很多的模板项目` vue-element-admin`、`Ant Design Pro`），能让我们快速的开始一个项目。\n\n虽然`React`、`Vue`为我们的组件开发提供了便利，但是这两者在组件的开发思路上，一个是自创的`JSX`语法，一个是特有的单文件模板的语法，两者的目标都是想提供一种组件的封装方法。毕竟都有其原创的东西在里面，和我们刚开始接触的 `Web`基础的`HTML`、`CSS`、`JS`的方式还是有些出入的。今天介绍的就是，通过`HTML`、`CSS`、`JS`的方式来实现自定义的组件，也是目前浏览器原生提供的方案：`Web Components`。\n\n### 什么是`Web Components`？\n`Web Components`本身不是一个单独的规范，而是由一组`DOM API`和`HTML`规范所组成，用于创建可复用的自定义名字的`HTML`标签，并且可以直接在你的`Web`应用中使用。\n\n代码的复用一直都是我们追求的目标，在`JS`中可复用的代码我们可以封装成一个函数，但是对于复杂的`HTML`（包括相关的样式及交互逻辑），我们一直都没有比较好的办法来进行复用。要么借助后端的模板引擎，要么借助已有框架`DOM API`的二次封装，而`Web Components`的出现就是为了补足浏览器在这方面的能力。\n\n### 如何使用`Web Components`？\n`Web Components`中包含的几个规范，都已在`W3C`和`HTML`标准中进行了规范化，主要由三部分组成：\n\n- `Custom elements`（自定义元素）：一组`JavaScript API`，用来创建自定义的`HTML`标签，并允许标签创建或销毁时进行一些操作；\n- `Shadow DOM`（影子`DOM`）：一组`JavaScript API`，用于将创建的`DOM Tree`插入到现有的元素中，且`DOM Tree`不能被外部修改，不用担心元素被其他地方影响；\n- `HTML templates`（`HTML`模板）：通过`<template>`、`<slot>`直接在 `HTML`文件中编写模板，然后通过`DOM API`获取。\n\n#### `Custom elements`（自定义元素）\n浏览器提供了一个方法：`customElements.define()`， 来进行自定义标签的定义。该方法接受三个参数：\n\n- 自定义元素的名称，一个`DOMString`标准的字符串，为了防止自定义元素的冲突，必须是一个带短横线连接的名称（`e.g. custom-tag`）。\n- 定义自定义元素的一些行为，类似于`React`、`Vue`中的生命周期。\n- 扩展参数（可选），该参数类型为一个对象，且需要包含`extends`属性，用于指定创建的元素继承自哪一个内置元素（`e.g. { extends: 'p' }`）。\n下面通过一些例子，演示其用法，完整代码放到了`JS Bin`上。\n\n创建一个新的`HTML`标签\n先看看如何创建一个全新的自定义元素。\n\n```js\nclass HelloUser extends HTMLElement {\n  constructor() {\n    // 必须调用 super 方法\n    super();\n\n    // 创建一个 div 标签\n    const $box = document.createElement(\"p\");\n    let userName = \"User Name\";\n    if (this.hasAttribute(\"name\")) {\n      // 如果存在 name 属性，读取 name 属性的值\n      userName = this.getAttribute(\"name\");\n    }\n    // 设置 div 标签的文本内容\n    $box.innerText = `Hello ${userName}`;\n\n    // 创建一个 shadow 节点，创建的其他元素应附着在该节点上\n    const shadow = this.attachShadow({ mode: \"open\" });\n    shadow.appendChild($box);\n  }\n}\n\n// 定义一个名为 <hello-user /> 的元素\ncustomElements.define(\"hello-user\", HelloUser);\n```\n\n```html\n<hello-user name=\"Shenfq\"></hello-user>\n```\n\n这时候页面上就会生成一个`<p>`标签，其文本内容为：`Hello Shenfq`。这种形式的自定义元素被称为：`Autonomous custom elements`，是一个独立的元素，可以在`HTML`中直接使用。","tags":[],"folderPathname":"/font","data":{},"createdAt":"2021-04-06T09:22:51.989Z","updatedAt":"2021-04-06T09:36:53.939Z","trashed":false,"_rev":"32YqwlJuK"}