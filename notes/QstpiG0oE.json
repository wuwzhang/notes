{"_id":"note:QstpiG0oE","title":"ç¬¬43æœŸ","content":"## 2021/05/18\n## æ¯å‘¨èµ„è®¯ - ç¬¬`43`æœŸ\n\n### 1. [Hi~ è¿™å°†æ˜¯ä¸€ä¸ªé€šç”¨çš„æ–°æ‰‹å¼•å¯¼è§£å†³æ–¹æ¡ˆ](https://mp.weixin.qq.com/s/vrDQEGgOSnKBvHuwZV6vSA)\n> æœ¬ç»„ä»¶å·²å¼€æºï¼Œæºç å¯è§ï¼šhttps://github.com/bytedance/guide\n\n#### ç»„ä»¶èƒŒæ™¯\nä¸ç®¡æ˜¯è€ç”¨æˆ·è¿˜æ˜¯æ–°ç”¨æˆ·ï¼Œåœ¨äº§å“å‘å¸ƒæ–°ç‰ˆæœ¬ã€æœ‰æ–°åŠŸèƒ½ä¸Šçº¿ã€æˆ–æ˜¯ç°æœ‰åŠŸèƒ½æ›´æ–°çš„åœºæ™¯ä¸‹ï¼Œéƒ½éœ€è¦ä¸€å®šçš„æŒ‡å¯¼ã€‚åŠŸèƒ½å¼•å¯¼ç»„ä»¶å°±æ˜¯äº’è”ç½‘äº§å“ä¸­çš„æŒ‡ç¤ºç‰Œï¼Œå®ƒæ—¨åœ¨å¸¦é¢†ç”¨æˆ·å‚è§‚äº§å“ï¼Œå¸®åŠ©ç”¨æˆ·ç†Ÿæ‚‰æ–°çš„ç•Œé¢ã€äº¤äº’ä¸åŠŸèƒ½ã€‚ä¸`FAQs`ã€äº§å“ä»‹ç»è§†é¢‘ã€ä½¿ç”¨æ‰‹å†Œã€ä»¥åŠ UI ç»„ä»¶å¸®åŠ©ä¿¡æ¯ä¸åŒçš„æ˜¯ï¼ŒåŠŸèƒ½å¼•å¯¼ç»„ä»¶ä¸äº§å“`UI`èåˆä¸ºä¸€ä½“ï¼Œä¸ä¼šç»™ç”¨æˆ·å‰²è£‚çš„äº¤äº’æ„Ÿå—ï¼Œå¹¶ä¸”ä¸éœ€è¦ç”¨æˆ·ä¸»åŠ¨è¿›è¡Œè§¦å‘æ“ä½œï¼Œå°±ä¼šå±•ç¤ºåœ¨ç”¨æˆ·çœ¼å‰ã€‚\n\nå›¾ç‰‡æ¯”æ–‡å­—æ›´åŠ å…·è±¡ï¼Œä»¥ä¸‹æ˜¯ä¸¤ç§å…¸å‹çš„æ–°æ‰‹å¼•å¯¼ç»„ä»¶ï¼Œä½ æ˜¯ä¸æ˜¯ä¸€çœ‹å°±æ˜ç™½åŠŸèƒ½å¼•å¯¼ç»„ä»¶æ˜¯ä»€ä¹ˆäº†å‘¢ï¼Ÿ\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ed5d2602d15f4a90bf60e2987db1cd9a~tplv-k3u1fbpfcp-zoom-1.image)\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/94258c9d775f453180be847808a5f895~tplv-k3u1fbpfcp-zoom-1.image)\n\n#### åŠŸèƒ½ç®€ä»‹\n##### åˆ†æ­¥å¼•å¯¼\n`Guide`ç»„ä»¶ä»¥åˆ†æ­¥å¼•å¯¼ä¸ºæ ¸å¿ƒï¼ŒåƒæŒ‡è·¯ç‰Œä¸€æ ·ï¼Œä¸€èŠ‚ä¸€èŠ‚åœ°å¼•å¯¼ç”¨æˆ·ä»èµ·ç‚¹åˆ°ç»ˆç‚¹ã€‚è¿™ç§å¼•å¯¼é€‚ç”¨äºäº¤äº’æµç¨‹è¾ƒé•¿çš„æ–°åŠŸèƒ½ï¼Œæˆ–æ˜¯ç•Œé¢æ¯”è¾ƒå¤æ‚çš„äº§å“ã€‚å®ƒå¸¦é¢†ç”¨æˆ·ä½“éªŒäº†å®Œæ•´çš„æ“ä½œé“¾è·¯ï¼Œå¹¶å¿«é€Ÿåœ°äº†è§£å„ä¸ªåŠŸèƒ½ç‚¹çš„ä½ç½®ã€‚\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/acbe804738a84ebe8abaf9ed89f4c7f8~tplv-k3u1fbpfcp-zoom-1.image)\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b2d8ca66477441bb8600e644edcae77b~tplv-k3u1fbpfcp-zoom-1.image)\n\n##### å‘ˆç°æ–¹å¼\n###### è’™å±‚æ¨¡å¼\né¡¾åæ€ä¹‰ï¼Œè’™å±‚å¼•å¯¼æ˜¯æŒ‡åœ¨äº§å“ä¸Šç”¨ä¸€ä¸ªåŠé€æ˜çš„é»‘è‰²è¿›è¡Œé®ç½©ï¼Œè’™å±‚ä¸Šæ–¹å¯¹ç•Œé¢è¿›è¡Œé«˜äº®ï¼Œæ—è¾¹é…ä»¥å¼¹çª—è¿›è¡Œè®²è§£ã€‚è¿™ç§å¼•å¯¼æ–¹å¼é˜»æ–­äº†ç”¨æˆ·ä¸ç•Œé¢çš„äº¤äº’ï¼Œè®©ç”¨æˆ·çš„æ³¨æ„åŠ›èšç„¦åœ¨æ‰€åœˆæ³¨çš„åŠŸèƒ½ç‚¹ä¸Šï¼Œä¸è¢«å…¶ä»–å…ƒç´ æ‰€å¹²æ‰°ã€‚\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/89de609c5f334ffc88351624c326611c~tplv-k3u1fbpfcp-zoom-1.image)\n\n###### å¼¹çª—æ¨¡å¼\nå¾ˆå¤šåœºæ™¯ä¸‹ï¼Œä¸ºäº†ä¸å¹²æ‰°ç”¨æˆ·ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³ä½¿ç”¨è’™å±‚ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ— è’™å±‚æ¨¡å¼ï¼Œå³åœ¨åŠŸèƒ½ç‚¹æ—è¾¹å¼¹å‡ºä¸€ä¸ªç®€å•çš„çª—å£å¼•å¯¼ã€‚\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4813474e361542308a69a55fe187ac04~tplv-k3u1fbpfcp-zoom-1.image)\n\n##### ç²¾å‡†å®šä½\n###### åˆå§‹å®šä½\n`Guide`æä¾›äº†`12`ç§å¯¹é½æ–¹å¼ï¼Œå°†å¼¹çª—å¼•å¯¼åŠ è½½åˆ°æ‰€é€‰æ‹©çš„å…ƒç´ ä¸Šã€‚åŒæ—¶ï¼Œè¿˜å…è®¸è‡ªå®šä¹‰æ¨ªçºµå‘åå·®å€¼ï¼Œå¯¹å¼¹çª—çš„ä½ç½®è¿›è¡Œè°ƒæ•´ã€‚ä¸‹å›¾åˆ†åˆ«å±•ç¤ºäº†å®šä½ä¸º`top-left`å’Œ`right-bottom`çš„å¼¹çª—ï¼š\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a4251b45245943aba93cdaa002b1a448~tplv-k3u1fbpfcp-zoom-1.image)\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b966b35f9f1d431cb5bbf8952cd4177d~tplv-k3u1fbpfcp-zoom-1.image)\nå¹¶ä¸”å½“ç”¨æˆ·ç¼©æ”¾æˆ–è€…æ»šåŠ¨é¡µé¢æ—¶ï¼Œå¼¹çª—çš„å®šä½ä¾ç„¶æ˜¯å‡†ç¡®çš„ã€‚\n\n##### è‡ªåŠ¨æ»šåŠ¨\nåœ¨å¾ˆå¤šæƒ…å¢ƒä¸­ï¼Œæˆ‘ä»¬éƒ½éœ€è¦å¯¹è·ç¦»è¾ƒè¿œçš„å‡ ä¸ªé¡µé¢å…ƒç´ è¿›è¡ŒåŠŸèƒ½è¯´æ˜ï¼Œä¸²è”æˆä¸€ä¸ªå®Œæ•´çš„å¼•å¯¼è·¯å¾„ã€‚å½“ä¸‹ä¸€æ­¥è¦åœˆæ³¨çš„åŠŸèƒ½ç‚¹ä¸åœ¨ç”¨æˆ·è§†é‡ä¸­æ—¶ï¼Œ`Guide`ä¼šè‡ªåŠ¨æ»šåŠ¨é¡µé¢è‡³åˆé€‚çš„ä½ç½®ï¼Œå¹¶å¼¹å‡ºå¼•å¯¼çª—å£ã€‚\n\n![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/50748d6e566e4e2c906040c25950cc7b~tplv-k3u1fbpfcp-watermark.image)\n\n##### é”®ç›˜æ“ä½œ\nå½“`Guide`å¼•å¯¼ç»„ä»¶å¼¹å‡ºæ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›ç”¨æˆ·çš„æ³¨æ„åŠ›è¢«å®Œå…¨å¸å¼•è¿‡æ¥ã€‚ä¸ºäº†è®©ä½¿ç”¨è¾…åŠ©é˜…è¯»å™¨çš„ç”¨æˆ·ä¹Ÿèƒ½å¤Ÿæ„ŸçŸ¥åˆ°`Guide`çš„å‡ºç°ï¼Œæˆ‘ä»¬å°†é¡µé¢ç„¦ç‚¹ç§»åŠ¨åˆ°å¼¹çª—ä¸Šï¼Œå¹¶ä¸”è®©å¼¹çª—é‡Œçš„æ¯ä¸€ä¸ªå¯è¯»å…ƒç´ éƒ½èƒ½å¤Ÿèšç„¦ã€‚åŒæ—¶ï¼Œç”¨æˆ·å¯ä»¥ç”¨é”®ç›˜ï¼ˆ`tab`æˆ–`tab+shift`ï¼‰ä¾æ¬¡èšç„¦å¼¹çª—é‡Œçš„å†…å®¹ï¼Œä¹Ÿå¯ä»¥æŒ‰`escape`é”®é€€å‡ºå¼•å¯¼ã€‚\n\nä¸‹å›¾ä¸­ï¼Œç”¨æˆ·ç”¨`tab`é”®åœ¨å¼¹çª—ä¸­ç§»åŠ¨ç„¦ç‚¹ï¼Œè¢«èšç„¦çš„å…ƒç´ ç”¨è™šçº¿æ¡†æ ‡è¯†å‡ºæ¥ã€‚å½“èšç„¦åˆ°â€œä¸‹ä¸€æ­¥â€æŒ‰é’®æ—¶ï¼Œæ•²å‡»`shift`é”®ï¼Œä¾¿å¯è·³è‡³ä¸‹ä¸€æ­¥å¼•å¯¼ã€‚\n\n![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/091441a942814431a1f89c03532d8e5e~tplv-k3u1fbpfcp-watermark.image)\n\n#### æŠ€æœ¯å®ç°\n##### æ€»ä½“æµç¨‹\nåœ¨å±•ç¤ºç»„ä»¶çš„æ­¥éª¤å‰æˆ‘ä»¬ä¼šå…ˆåˆ¤æ–­æ˜¯å¦è¿‡æœŸï¼Œåˆ¤æ–­æ˜¯å¦è¿‡æœŸçš„æ ‡å‡†æœ‰ä¸¤ä¸ªï¼šä¸€ä¸ªæ˜¯è¯¥å¼•å¯¼ç»„ä»¶åœ¨`localStorage`ä¸­å­˜å‚¨å”¯ä¸€`key`æ˜¯å¦ä¸º`true`ï¼Œä¸º`true`åˆ™ä¸ºè¯¥ç»„ä»¶æ­¥éª¤æ‰§è¡Œå®Œæ¯•ã€‚ç¬¬äºŒä¸ªæ˜¯ç»„ä»¶æ¥æ”¶ä¸€ä¸ª`props.expireDate`ï¼Œå¦‚æœå½“å‰æ—¶é—´å¤§äº`expireDate`åˆ™ä»£è¡¨ç»„ä»¶å·²ç»è¿‡æœŸåˆ™ä¸ä¼šç»§ç»­å±•ç¤ºã€‚\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/be999ad4059c4f16811fe858f9260a89~tplv-k3u1fbpfcp-zoom-1.image)\n\nå½“ç»„ä»¶æ²¡æœ‰è¿‡æœŸæ—¶ï¼Œä¼šå±•ç¤ºä¼ å…¥çš„`props.steps`ç›¸åº”çš„å†…å®¹ï¼Œ`steps`ç»“æ„å¦‚ä¸‹ï¼š\n\n```ts\ninterface Step {\n    selector: string;\n    title: string;\n    content: React.Element | string;\n    placement: 'top' | 'bottom' | 'left' | 'right'\n        | 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right',\n    offset: Record<'top' | 'bottom' | 'left' | 'right', number>\n}\n\nconst steps = Step[]\n```\n\næ ¹æ®`step.selector`è·å–é«˜äº®å…ƒç´ ï¼Œå†æ ¹æ®`step.placement`å°†å¼¹çª—å±•ç¤ºåˆ°é«˜äº®å…ƒç´ ç›¸å…³çš„å…·ä½“ä½ç½®ã€‚ç‚¹å‡»ä¸‹ä¸€æ­¥ä¼šæŒ‰åºå±•ç¤ºä¸‹ä¸ª`step`ï¼Œå½“æ‰€æœ‰æ­¥éª¤å±•ç¤ºå®Œæ¯•ä¹‹åæˆ‘ä»¬ä¼šå°†è¯¥å¼•å¯¼ç»„ä»¶åœ¨`localStorage`ä¸­å­˜å‚¨å”¯ä¸€`key`ç½®ä¸º`true`ï¼Œä¸‹æ¬¡è¿›æ¥å°†ä¸å†å±•ç¤ºã€‚\n\nä¸‹é¢æ¥çœ‹çœ‹å¼•å¯¼ç»„ä»¶çš„å…·ä½“ç»†èŠ‚å®ç°å§ã€‚\n\n##### è’™å±‚æ¨¡å¼\nå½“å‰çš„å¼•å¯¼ç»„ä»¶æ”¯æŒæœ‰æ— è’™å±‚ä¸¤ç§æ¨¡å¼ï¼Œæœ‰è’™å±‚çš„å±•ç¤ºæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c11995841a374eedb70cf2c41925e107~tplv-k3u1fbpfcp-zoom-1.image)\n\nè’™å±‚å¾ˆå¥½å®ç°ï¼Œå°±æ˜¯ä¸€ä¸ªæ’‘æ»¡å±å¹•çš„`div`ï¼Œä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆæ‰èƒ½è®©å®ƒåšåˆ°é«˜äº®å‡ºä¸­é—´çš„ `selector`å…ƒç´ å¹¶ä¸”è¿˜æ”¯æŒåœ†è§’å‘¢ï¼ŸğŸ¤” ï¼ŒçœŸç›¸åªæœ‰ä¸€ä¸ªï¼Œé‚£å°±æ˜¯â€”â€” `border-width`\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/924a03989ce3447e9314a3cb3c758503~tplv-k3u1fbpfcp-zoom-1.image)\n\næˆ‘ä»¬æ‹¿åˆ°äº†`selector`å…ƒç´ çš„`offsetTop`, `offsetRight`, `offsetBottom`, `offsetLeft`ï¼Œå¹¶ç›¸åº”åœ°è®¾ç½®ä¸ºé«˜äº®æ¡†çš„`border-width`ï¼Œå†æŠŠ`border-color`è®¾ç½®ä¸ºç°è‰²ï¼Œä¸€ä¸ªå¸¦æœ‰é«˜äº®æ¡†çš„è’™å±‚å°±å®ç°å•¦ï¼åœ¨ç»™è¿™ä¸ªé«˜äº®æ¡†`div`åŠ ä¸ª`pseudo-element ::after`æ¥èµ‹äºˆå®ƒ`border-radius`ï¼Œå®Œç¾ï¼\n\n##### å¼¹çª—çš„å®šä½\nç”¨æˆ·ä½¿ç”¨`Guide`æ—¶ï¼Œä¼ å…¥äº†æ­¥éª¤ä¿¡æ¯ï¼Œæ¯ä¸€æ­¥éƒ½åŒ…æ‹¬äº†æ‰€è¦è¿›è¡Œå¼•å¯¼è¯´æ˜çš„ç•Œé¢å…ƒç´ çš„ `CSS`é€‰æ‹©å™¨ã€‚æˆ‘ä»¬å°†æ‰€è¦æ ‡æ³¨çš„å…ƒç´ å«åšâ€œé”šå…ƒç´ â€ã€‚`Guide`éœ€è¦æ ¹æ®é”šå…ƒç´ çš„ä½ç½®ä¿¡æ¯ï¼Œå‡†ç¡®åœ°å®šä½å¼¹çª—ã€‚\n\næ¯ä¸€ä¸ª`HTML`å…ƒç´ éƒ½æœ‰ä¸€ä¸ªåªè¯»å±æ€§`offsetParent`ï¼Œå®ƒæŒ‡å‘æœ€è¿‘çš„ï¼ˆæŒ‡åŒ…å«å±‚çº§ä¸Šçš„æœ€è¿‘ï¼‰åŒ…å«è¯¥å…ƒç´ çš„å®šä½å…ƒç´ æˆ–è€…æœ€è¿‘çš„`table,td,th,body`å…ƒç´ ã€‚æ¯ä¸ªå…ƒç´ éƒ½æ˜¯æ ¹æ®å®ƒçš„`offsetParent`å…ƒç´ è¿›è¡Œå®šä½çš„ã€‚æ¯”å¦‚è¯´ï¼Œä¸€ä¸ª`absolute`å®šä½çš„å…ƒç´ ï¼Œæ˜¯æ ¹æ®å®ƒæœ€è¿‘çš„ã€é`static`å®šä½çš„ä¸Šçº§å…ƒç´ è¿›è¡Œåç§»çš„ï¼Œè¿™ä¸ªä¸Šçº§å…ƒç´ ï¼Œå°±æ˜¯å…¶çš„ `offsetParent`ã€‚\n\næ‰€ä»¥æˆ‘ä»¬æƒ³åˆ°å°†å¼¹çª—å…ƒç´ æ”¾è¿›é”šå…ƒç´ çš„`offsetParent`ä¸­ï¼Œå†å¯¹å…¶ä½ç½®è¿›è¡Œè°ƒæ•´ã€‚åŒæ—¶ï¼Œä¸ºäº†ä¸è®©é”šå…ƒç´ `offsetParent`ä¸­çš„å…¶å®ƒå…ƒç´ äº§ç”Ÿä½ç§»ï¼Œæˆ‘ä»¬è®¾å®šå¼¹çª—å…ƒç´ ä¸º`absolute`ç»å¯¹å®šä½ã€‚\n\n##### å®šä½æ­¥éª¤\nå¼¹çª—çš„å®šä½è®¡ç®—æµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6bb763605e9345b4b6513ac20c18f6f0~tplv-k3u1fbpfcp-zoom-1.image)\n\n1. å¾—åˆ°é”šå…ƒç´ \n\né€šè¿‡ä¼ ç»™`Guide`çš„æ­¥éª¤ä¿¡æ¯ä¸­çš„`selector`ï¼Œå³`CSS selector`ï¼Œæˆ‘ä»¬å¯ä»¥ç”±ä¸‹è¿°ä»£ç æ‹¿åˆ°é”šå…ƒç´ ï¼š\n\n```js\nconst anchor = document.querySelector(selector);\n```\nå¦‚ä½•æ‹¿åˆ°`anchor`çš„`offsetParent`å‘¢ï¼Ÿè¿™ä¸€æ­¥å…¶å®å¹¶æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆç®€å•ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥è¯¦ç»†åœ°è®²ä¸€è®²è¿™ä¸€æ­¥å§ã€‚\n\n2. è·å–`offsetParent`\n\nä¸€èˆ¬æ¥è¯´ï¼Œæ‹¿åˆ°é”šå…ƒç´ çš„`offsetParent`ï¼Œä¹Ÿåªéœ€è¦ç®€å•çš„ä¸€è¡Œä»£ç ï¼š\n```js\nconst parent = anchor.offsetParent;\n```\n\nä½†æ˜¯è¿™è¡Œä»£ç å¹¶ä¸èƒ½æ¶µç›–æ‰€æœ‰çš„åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸€äº›ç‰¹æ®Šçš„æƒ…å†µã€‚\n\n**åœºæ™¯ä¸€ï¼šé”šå…ƒç´ ä¸º`fixed`å®šä½**\n\nå¹¶ä¸æ˜¯æ‰€æœ‰çš„`HTMLElement`éƒ½æœ‰`offsetParent`å±æ€§ã€‚å½“é”šå…ƒç´ ä¸º`fixed`å®šä½æ—¶ï¼Œå…¶`offsetParent`è¿”å›`null`ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨å…¶ **åŒ…å«å—**ï¼ˆ`containing block`ï¼‰ ä»£æ›¿`offsetParent`äº†ã€‚\n\nåŒ…å«å—æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒåŒ…å«å—å°±æ˜¯è¿™ä¸ªå…ƒç´ æœ€è¿‘çš„ç¥–å…ˆå—å…ƒç´ çš„å†…å®¹åŒºï¼Œä½†ä¹Ÿä¸æ˜¯æ€»æ˜¯è¿™æ ·ã€‚ä¸€ä¸ªå…ƒç´ çš„åŒ…å«å—æ˜¯ç”±å…¶`position`å±æ€§å†³å®šçš„ã€‚\n\n- å¦‚æœ`position`å±æ€§æ˜¯`fixed`ï¼ŒåŒ…å«å—é€šå¸¸æ˜¯`document.documentElement`ã€‚\n- å¦‚æœ`position`å±æ€§æ˜¯`fixed`ï¼ŒåŒ…å«å—ä¹Ÿå¯èƒ½æ˜¯ç”±æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„æœ€è¿‘çˆ¶çº§å…ƒç´ çš„å†…è¾¹è·åŒºçš„è¾¹ç¼˜ç»„æˆçš„ï¼š\n  - `transform` æˆ–`perspective`çš„å€¼ä¸æ˜¯`none`\n  - `will-change` çš„å€¼æ˜¯`transform`æˆ–`perspective`\n  - `filter`çš„å€¼ä¸æ˜¯`none`æˆ–`will-change`çš„å€¼æ˜¯`filter`(åªåœ¨`Firefox`ä¸‹ç”Ÿæ•ˆ).\n  - `contain`çš„å€¼æ˜¯`paint` (ä¾‹å¦‚: `contain: paint`;)\n  \nå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä»é”šå…ƒç´ å¼€å§‹ï¼Œé€’å½’åœ°å‘ä¸Šå¯»æ‰¾ç¬¦åˆä¸Šè¿°æ¡ä»¶çš„çˆ¶çº§å…ƒç´ ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆå°±è¿”å›`document.documentElement`ã€‚\n\nä¸‹é¢æ˜¯`Guide`ä¸­ç”¨æ¥å¯»æ‰¾åŒ…å«å—çš„ä»£ç ï¼š\n```js\nconst getContainingBlock = node => {\n  let currentNode = getDocument(node).documentElement;\n\n  while (\n    isHTMLElement(currentNode) &&\n    !['html', 'body'].includes(getNodeName(currentNode))\n  ) {\n    const css = getComputedStyle(currentNode);\n\n    if (\n      css.transform !== 'none' ||\n      css.perspective !== 'none' ||\n      (css.willChange && css.willChange !== 'auto')\n    ) {\n      return currentNode;\n    }\n    currentNode = currentNode.parentNode;\n  }\n\n  return currentNode;\n};\n```\n**åœºæ™¯äºŒï¼šåœ¨`iframe`ä¸­ä½¿ç”¨`Guide`**\n\nåœ¨`Guide`çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸ç”¨åˆ°`window`å¯¹è±¡ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬éœ€è¦åœ¨`window`å¯¹è±¡ä¸Šè°ƒç”¨`getComputedStyle()`è·å–å…ƒç´ çš„æ ·å¼ï¼Œæˆ‘ä»¬è¿˜éœ€è¦`window`å¯¹è±¡ä½œä¸ºå…ƒç´  `offsetParent`çš„å…œåº•ã€‚ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥ä½¿ç”¨`window`å¯¹è±¡ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¿™æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘`iframe`çš„æƒ…å†µã€‚\n\næƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä¸€ä¸ªå†…åµŒäº†`iframe`çš„åº”ç”¨ä¸­ä½¿ç”¨`Guide`ç»„ä»¶ï¼Œ`Guide`ç»„ä»¶ä»£ç åœ¨`iframe`å¤–é¢ï¼Œè€Œè¢«å¼•å¯¼çš„åŠŸèƒ½ç‚¹åœ¨`iframe`é‡Œé¢ï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨`Window`å¯¹è±¡æä¾›çš„æ–¹æ³•æ˜¯ï¼Œæˆ‘ä»¬ä¸€å®šæ˜¯æƒ³åœ¨æ‰€åœˆæ³¨çš„åŠŸèƒ½ç‚¹æ‰€åœ¨çš„`Window`å¯¹è±¡ä¸Šè¿›è¡Œè°ƒç”¨ï¼Œè€Œéå½“å‰ä»£ç è¿è¡Œçš„`Window`ã€‚\n\nå› æ­¤ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„`getWindow`æ–¹æ³•ï¼Œç¡®ä¿æ‹¿åˆ°çš„æ˜¯å‚æ•°`node`æ‰€åœ¨çš„`Window`ã€‚\n\n```js\n// Get the window object using this function rather then simply use `window` because\n// there are cases where the window object we are seeking to reference is not in\n// the same window scope as the code we are running. (https://stackoverflow.com/a/37638629)\nconst getWindow = node => {\n  // if node is not the window object\n  if (node.toString() !== '[object Window]') {\n    // get the top-level document object of the node, or null if node is a document.\n    const { ownerDocument } = node;\n    // get the window object associated with the document, or null if none is available.\n    return ownerDocument ? ownerDocument.defaultView || window : window;\n  }\n\n  return node;\n};\n```\nåœ¨`line 8`ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªå±æ€§`ownerDocument`ã€‚å¦‚æœ`node`æ˜¯ä¸€ä¸ª`DOM Element`ï¼Œé‚£ä¹ˆå®ƒå…·æœ‰ä¸€ä¸ªå±æ€§`ownerDocument`ï¼Œæ­¤å±æ€§è¿”å›çš„`document`å¯¹è±¡æ˜¯åœ¨å®é™…çš„`HTML`æ–‡æ¡£ä¸­çš„æ‰€æœ‰å­èŠ‚ç‚¹æ‰€å±çš„ä¸»å¯¹è±¡ã€‚å¦‚æœåœ¨æ–‡æ¡£èŠ‚ç‚¹è‡ªèº«ä¸Šä½¿ç”¨æ­¤å±æ€§ï¼Œåˆ™ç»“æœæ˜¯`null`ã€‚å½“`node`ä¸º`Window`å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬è¿”å›`window`ï¼›å½“`node`ä¸º` Document`å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬è¿”å›äº†`ownerDocument.defaultView`ã€‚è¿™æ ·ï¼Œ`getWindow `å‡½æ•°ä¾¿æ¶µç›–äº†å‚æ•°`node`çš„æ‰€æœ‰å¯èƒ½æ€§ã€‚\n\n 3. æŒ‚è½½å¼¹çª—\n \nå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼Œæˆ‘ä»¬å¸¸å¸¸é‡åˆ°çš„ä½¿ç”¨åœºæ™¯æ˜¯ï¼Œåœ¨ç»„ä»¶`A`ä¸­æ¸²æŸ“`Guide`ï¼Œè®©å…¶å»æ ‡æ³¨çš„å…ƒç´ å´åœ¨ç»„ä»¶`B`ã€ç»„ä»¶`C`ä¸­ã€‚\n```jsx\n // ç»„ä»¶A\n const A = props => (\n    <>\n        <Guide\n            steps={[\n                {\n                    ......\n                    selector: '#btn1'\n                },\n                {\n                    ......\n                    selector: '#btn2'\n                },\n                {\n                    ......\n                    selector: '#btn3'\n                }\n            ]}\n        />\n        <button id=\"btn1\">Button 1</button>\n    </>\n)\n```\n\n```jsx\n// ç»„ä»¶B\nconst B = props => (<button id=\"btn2\">Button 2</button>)\n```\n\n```jsx\n// ç»„ä»¶C\nconst C = props => (<button id=\"btn3\">Button 3</button>)\n```\n\nä¸Šè¿°ä»£ç ä¸­ï¼Œ`Guide`ä¼šè‡ªç„¶è€Œç„¶åœ°æ¸²æŸ“åœ¨`A`ç»„ä»¶`DOM`ç»“æ„ä¸‹ï¼Œæˆ‘ä»¬æ€æ ·å°†å…¶æŒ‚è½½åˆ°ç»„ä»¶`B`ã€`C`çš„`offsetParent`ä¸­å‘¢ï¼Ÿè¿™æ—¶å€™å°±è¦ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹å¼ºå¤§å´å°‘ä¸ºäººçŸ¥çš„ `React Portals`äº†ã€‚\n\n**React Portals**\n\nå½“æˆ‘ä»¬éœ€è¦æŠŠä¸€ä¸ªç»„ä»¶æ¸²æŸ“åˆ°å…¶çˆ¶èŠ‚ç‚¹æ‰€åœ¨çš„`DOM`æ ‘ç»“æ„ä¹‹å¤–æ—¶ï¼Œ æˆ‘ä»¬é¦–å…ˆåº”è¯¥è€ƒè™‘ä½¿ç”¨`React Portals`ã€‚`Portals`æœ€é€‚ç”¨äºè¿™ç§éœ€è¦å°†å­èŠ‚ç‚¹ä»è§†è§‰ä¸Šæ¸²æŸ“åˆ°å…¶çˆ¶èŠ‚ç‚¹ä¹‹å¤–çš„åœºæ™¯äº†ï¼Œåœ¨`Antd`çš„`Modal`ã€`Popover`ã€`Tooltip`ç»„ä»¶å®ç°ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°`Portal`çš„åº”ç”¨ã€‚\n\næˆ‘ä»¬ä½¿ç”¨`ReactDOM.createPortal(child, container)`åˆ›å»ºä¸€ä¸ª`Portal`ã€‚`child` æ˜¯æˆ‘ä»¬è¦æŒ‚è½½çš„ç»„ä»¶ï¼Œ`container`åˆ™æ˜¯`child`è¦æŒ‚è½½åˆ°çš„å®¹å™¨ç»„ä»¶ã€‚\n\nè™½ç„¶`Portal`æ˜¯æ¸²æŸ“åœ¨å…¶çˆ¶å…ƒç´ `DOM`ç»“æ„ä¹‹å¤–çš„ï¼Œä½†æ˜¯å®ƒå¹¶ä¸ä¼šåˆ›å»ºä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„ `React DOM`æ ‘ã€‚ä¸€ä¸ª`Portal`ä¸`React`æ ‘ä¸­å…¶å®ƒå­èŠ‚ç‚¹ç›¸åŒï¼Œéƒ½å¯ä»¥æ‹¿åˆ°çˆ¶ç»„ä»¶çš„ä¼ æ¥çš„`props`å’Œ`context`ï¼Œä¹Ÿéƒ½å¯ä»¥è¿›è¡Œäº‹ä»¶å†’æ³¡ã€‚\n\nå¦å¤–ï¼Œä¸`ReactDOM.render`æ‰€åˆ›å»ºçš„`React DOM`æ ‘ä¸åŒï¼Œ`ReactDOM.createPortal`æ˜¯åº”ç”¨åœ¨ç»„ä»¶çš„`render`å‡½æ•°ä¸­çš„ï¼Œå› æ­¤ä¸éœ€è¦æ‰‹åŠ¨å¸è½½ã€‚\n\nåœ¨`Guide`ä¸­ï¼Œæ¯è·³ä¸€æ­¥ï¼Œä¸Šä¸€æ­¥çš„å¼¹çª—ä¾¿ä¼šå¸è½½æ‰ï¼Œæ–°çš„å¼¹çª—ä¼šè¢«åŠ è½½åˆ°è¿™ä¸€æ­¥è¦åœˆæ³¨çš„å…ƒç´ çš„`offsetParent`é‡Œã€‚ä¼ªä»£ç å¦‚ä¸‹ï¼š\n\n```jsx\nconst Modal = props => (\n    ReactDOM.createPortal(\n        <div>\n            ......\n        </div>,\n    offsetParent);\n)\n```\n\nå°†å¼¹çª—æ¸²æŸ“è¿›`offsetParent`åï¼Œ`Guide`çš„ä¸‹ä¸€æ­¥å·¥ä½œä¾¿æ˜¯è®¡ç®—å¼¹çª—ç›¸å¯¹äº `offsetParent`çš„åç§»é‡ã€‚è¿™ä¸€æ­¥éå¸¸å¤æ‚ï¼Œå¹¶ä¸”è¦è€ƒè™‘ä¸€äº›ç‰¹æ®Šæƒ…å†µã€‚ä¸‹é¢å°±è®©æˆ‘ä»¬å°±ä»”ç»†åœ°è®²è§£è¿™éƒ¨åˆ†è®¡ç®—å§ã€‚\n\n4. åç§»é‡è®¡ç®—\n\nä»¥ä¸€ä¸ª`placement = left` ï¼Œå³éœ€è¦åœ¨åŠŸèƒ½ç‚¹å·¦ä¾§å±•ç¤ºçš„å¼¹çª—å¼•å¯¼ä¸ºä¾‹ã€‚å¦‚æœæˆ‘ä»¬ç›´æ¥æŠŠå¼¹çª—é€šè¿‡`React Portal`æŒ‚è½½åˆ°é”šå…ƒç´ çš„`offsetParent`ä¸­ï¼Œå¹¶èµ‹äºˆå…¶ç»å¯¹å®šä½ï¼Œå…¶ä½ç½®ä¼šå¦‚ä¸‹å›¾æ‰€ç¤ºâ€”â€”å·¦ä¸Šè§’ä¸`offsetParent`çš„å·¦ä¸Šè§’å¯¹é½ã€‚\n\n_\nä¸‹å›¾ä¸­ï¼Œç”¨**è“è‰²æ¡†**è¡¨ç¤ºçš„è€ƒæ‹‰å›¾ç‰‡æ˜¯`Guide`éœ€è¦æ ‡æ³¨çš„å…ƒç´ ï¼Œå³é”šå…ƒç´ ï¼›**çº¢è‰²æ¡†**åˆ™æ ‡è¯†å‡ºè¿™ä¸ªé”šå…ƒç´ çš„`offsetParent`å…ƒç´ ã€‚_\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/464b29bb644f430f9dd8b7142b0a7218~tplv-k3u1fbpfcp-zoom-1.image)\n\nè€Œæˆ‘ä»¬é¢„æƒ³çš„å®šä½ç»“æœå¦‚ä¸‹ï¼š\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8c0233f64d2c4a3098d00367f11c20e6~tplv-k3u1fbpfcp-zoom-1.image)\n\nå‚è€ƒä¸‹å›¾ï¼Œå°†å¼¹çª—ä»åˆå§‹ä½ç½®ç§»åŠ¨è‡³é¢„æœŸä½ç½®ï¼Œæˆ‘ä»¬éœ€è¦åœ¨`y`è½´ä¸Šå‘ä¸‹ç§»åŠ¨å¼¹çª— `offsetTop + h1/2 - h2/2 px`ã€‚å…¶ä¸­ï¼Œ`h1`ä¸ºé”šå…ƒç´ çš„é«˜åº¦ï¼Œ`h2`ä¸ºå¼¹çª—çš„é«˜åº¦ã€‚\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2fd1ec4438064914bb36e69082b6899b~tplv-k3u1fbpfcp-zoom-1.image)\n\nä½†æ˜¯ï¼Œä¸Šè¿°è®¡ç®—ä¾ç„¶å¿½ç•¥äº†ä¸€ç§åœºæ™¯ï¼Œé‚£å°±æ˜¯å½“é”šå…ƒç´ å®šä½ä¸º`fixed`æ—¶ã€‚è‹¥é”šå…ƒç´ å®šä½ä¸º fixedï¼Œé‚£ä¹ˆæ— è®ºé”šå…ƒç´ æ‰€åœ¨çš„ç•Œé¢æ€æ ·æ»‘åŠ¨ï¼Œé”šå…ƒç´ ç›¸å¯¹äºå±å¹•è§†å£ï¼ˆ`viewport`ï¼‰çš„ä½ç½®æ˜¯å›ºå®šçš„ã€‚è‡ªç„¶ï¼Œç”¨æ¥å¯¹`fixed`é”šå…ƒç´ è¿›è¡Œå¼•å¯¼çš„å¼¹çª—ä¹Ÿéœ€è¦å…·æœ‰è¿™äº›ç‰¹æ€§ï¼Œå³åŒæ ·éœ€è¦ä¸º`fixed`å®šä½ã€‚\n\n##### `Arrow`å®ç°åŠå®šä½\n`arrow`æ˜¯`modal`çš„å­å…ƒç´ ä¸”ç›¸å¯¹äº`modal`ç»å¯¹å®šä½ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºæœ‰åäºŒç§å±•ç¤ºä½ç½®ï¼Œæˆ‘ä»¬æŠŠåäºŒç§å®šä½åˆ†ä¸ºä¸¤ç±»æƒ…å†µï¼š\n\n1. ç´«è‰²çš„å››ç§å±…ä¸­æƒ…å†µï¼›\n2. é»„è‰²çš„å…¶ä½™å…«ç§æ–œè§’ã€‚\n\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2fd1ec4438064914bb36e69082b6899b~tplv-k3u1fbpfcp-zoom-1.image)\n\nå¯¹äºç¬¬ä¸€ç±»æƒ…å†µ\n\nç®­å¤´å§‹ç»ˆæ˜¯ç›¸å¯¹å¼¹çª—è¾¹ç¼˜å±…ä¸­çš„ä½ç½®ï¼Œå‡ºå¯¹äº`top`ã€`bottom`ï¼Œç®­å¤´çš„`right`å€¼å§‹ç»ˆæ˜¯`(modal.width - arrow.diagonalWidth)/2` ï¼Œè€Œ`top`æˆ–`bottom`å€¼å§‹ç»ˆä¸º`-arrow.diagonalWidth/2`ã€‚\n\nå¯¹äº`left`ã€`right`ï¼Œç®­å¤´çš„`top`å€¼æ˜¯`(modal.height - arrow.diagonalWidth)/2`ï¼Œè€Œ`left`æˆ–`right`ä¸º`-arrow.diagonalWidth/2`ã€‚\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cf4758fe39cc436fa67882df7c9bdd05~tplv-k3u1fbpfcp-zoom-1.image)\n\n_æ³¨ï¼š`diagonalWidth`ä¸ºå¯¹è§’çº¿å®½åº¦ï¼Œ`getReversePosition\\(placement\\)`ä¸ºè·å–ä¼ å…¥å‚æ•°çš„ `reverse`ä½ç½®ï¼Œ`top`å¯¹åº”`bottom`ï¼Œ`left`å¯¹åº”`right`ã€‚_\n\nä¼ªä»£ç å¦‚ä¸‹ï¼š\n```jsx\nconst placement = 'top' | 'bottom' | 'left' | 'right';\nconst diagonalWidth = 10;\n\nconst style = {\n  right: ['bottom', 'top'].includes(placement)\n    ? (modal.width - diagonalWidth) / 2\n    : '',\n  top: ['left', 'right'].includes(placement)\n    ? (modal.height - diagonalWidth) / 2\n    : '',\n    [getReversePosition(placement)]: -diagonalWidth / 2,\n};\n```\n\nå¯¹äºç¬¬äºŒç±»æƒ…å†µ\n\nå¯¹äº`A-B`çš„ä½ç½®ï¼Œé€šè¿‡ä¸‹å›¾å¯ä»¥å‘ç°ï¼Œ`B`çš„ä½ç§»æ€»æ˜¯å›ºå®šå€¼ã€‚æ¯”å¦‚å¯¹äº`placement`å€¼ä¸º`top-left`çš„å¼¹çª—ï¼Œç®­å¤´`left`å€¼æ€»æ˜¯å›ºå®šçš„ï¼Œè€Œ`bottom`å€¼ä¸º`-arrow.diagonalWidth/2`ã€‚\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5de933a715b6445e96c3efdc56f46f1e~tplv-k3u1fbpfcp-zoom-1.image)\n\nä»¥ä¸‹ä¸ºä¼ªä»£ç ï¼š\n```jsx\nconst [firstPlacement, lastPlacement] = placement.split('-');\nconst diagonalWidth = 10;\nconst margin = 24;\n\nconst style =  {\n    [lastPlacement]: margin,\n    [getReversePosition(placement)]: -diagonalWidth / 2,\n}\n```\n\n##### `Hotspot`å®ç°åŠå®šä½\nå¼•å¯¼ç»„ä»¶æ”¯æŒ`hotspot`åŠŸèƒ½ï¼Œé€šè¿‡ç»™ä¸€ä¸ª`div`å…ƒç´ åŠ ä¸ŠåŠ¨ç”»æ”¹å˜å…¶`box-shadow`å¤§å°å®ç°å‘¼å¸ç¯çš„æ•ˆæœï¼Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…¶ä¸­çƒ­ç‚¹çš„å®šä½æ˜¯ç›¸å¯¹ç®­å¤´çš„ä½ç½®è®¡ç®—çš„ï¼Œè¿™é‡Œä¾¿ä¸èµ˜è¿°äº†ã€‚\n\n![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/da08384783c14c9aa825154a8102fd47~tplv-k3u1fbpfcp-zoom-1.image)\n#### ç›¸å…³æ–‡ç« \n- [Hi~ è¿™å°†æ˜¯ä¸€ä¸ªé€šç”¨çš„æ–°æ‰‹å¼•å¯¼è§£å†³æ–¹æ¡ˆ](https://mp.weixin.qq.com/s/vrDQEGgOSnKBvHuwZV6vSA)\n\n### 2. [å¬å¬å°¤é›¨æºªè®²è¿°è‡ªå·±çš„å¿ƒè·¯å†ç¨‹](https://www.zhihu.com/zvideo/1227591095011733504?utm_source=wechat_session&utm_medium=social&utm_oi=803272998449725440)\nçŸ¥ä¹ï¼Œä¸­æ–‡äº’è”ç½‘é«˜è´¨é‡çš„é—®ç­”ç¤¾åŒºå’Œåˆ›ä½œè€…èšé›†çš„åŸåˆ›å†…å®¹å¹³å°ï¼Œäº 2011 å¹´ 1 æœˆæ­£å¼ä¸Šçº¿ï¼Œä»¥ã€Œè®©äººä»¬æ›´å¥½åœ°åˆ†äº«çŸ¥è¯†ã€ç»éªŒå’Œè§è§£ï¼Œæ‰¾åˆ°è‡ªå·±çš„è§£ç­”ã€ä¸ºå“ç‰Œä½¿å‘½ã€‚çŸ¥ä¹å‡­å€Ÿè®¤çœŸã€ä¸“ä¸šã€å‹å–„çš„ç¤¾åŒºæ°›å›´ã€ç‹¬ç‰¹çš„äº§å“æœºåˆ¶ä»¥åŠç»“æ„åŒ–å’Œæ˜“è·å¾—çš„ä¼˜è´¨å†…å®¹ï¼Œèšé›†äº†ä¸­æ–‡äº’è”ç½‘ç§‘æŠ€ã€å•†ä¸šã€å½±è§†ã€æ—¶å°šã€æ–‡åŒ–ç­‰é¢†åŸŸæœ€å…·åˆ›é€ åŠ›çš„äººç¾¤ï¼Œå·²æˆä¸ºç»¼åˆæ€§ã€å…¨å“ç±»ã€åœ¨è¯¸å¤šé¢†åŸŸå…·æœ‰å…³é”®å½±å“åŠ›çš„çŸ¥è¯†åˆ†äº«ç¤¾åŒºå’Œåˆ›ä½œè€…èšé›†çš„åŸåˆ›å†…å®¹å¹³å°ï¼Œå»ºç«‹èµ·äº†ä»¥ç¤¾åŒºé©±åŠ¨çš„å†…å®¹å˜ç°å•†ä¸šæ¨¡å¼ã€‚\n\n\n#### ç›¸å…³æ–‡ç« \n- [å¬å¬å°¤é›¨æºªè®²è¿°è‡ªå·±çš„å¿ƒè·¯å†ç¨‹](https://www.zhihu.com/zvideo/1227591095011733504?utm_source=wechat_session&utm_medium=social&utm_oi=803272998449725440)\n\n## 30 seconds of code\n### ç›®æ ‡\nä½¿ç”¨`JavaScript`å®ç°å•ä¾‹\n\n### æ ·ä¾‹è¾“å‡º: \n```js\nclass MyClass {\n  constructor(msg) {\n    this.msg = msg;\n  }\n\n  printMsg() {\n    console.log(this.msg);\n  }\n}\n\nMySingletonClass = singletonify(MyClass);\n\nconst myObj = new MySingletonClass('first');\nmyObj.printMsg();           // 'first'\nconst myObj2 = new MySingletonClass('second');\nmyObj2.printMsg();           // 'first'\n```\n### å‚è€ƒå®ç°\n```js\nconst singletonify = (className) => {\n  return new Proxy(className.prototype.constructor, {\n    instance: null,\n    construct: (target, argumentsList) => {\n      if (!this.instance)\n        this.instance = new target(...argumentsList);\n      return this.instance;\n    }\n  });\n}\n```\n## æ¯æ—¥ä¸€é—®\n> å®ç°ä¸€ä¸ªç®€å•çš„æ¨¡æ¿å¼•æ“ï¼š\n\n```js    \nlet template = 'æˆ‘æ˜¯{{name}}ï¼Œå¹´é¾„{{age}}ï¼Œæ€§åˆ«{{sex}}';\nlet data = {\n  name: 'å§“å',\n  age: 18\n}\n\nrender(template, data); // æˆ‘æ˜¯å§“åï¼Œå¹´é¾„18ï¼Œæ€§åˆ«undefined\n```\n\n## æ¯æ—¥äºŒé—®\n> æŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­å‡ºç°æœ€å¤šçš„å­—ç¬¦å’Œä¸ªæ•°\n\nä¾‹: abbcccddddd -> ['d', 5]\n\n### ä¸ŠæœŸçš„ç­”æ¡ˆ\n#### ç¬¬ä¸€é¢˜\n> å®ç°ä¸€ä¸ªJSON.stringify\n\n```js\nJSON.stringify(value[, replacer [, space]])\n```\n```js\nfunction jsonStringify(obj) {\n    let type = typeof obj;\n    if (type !== \"object\") {\n        if (/string|undefined|function/.test(type)) {\n            obj = '\"' + obj + '\"';\n        }\n        return String(obj);\n    } else {\n        let json = []\n        let arr = Array.isArray(obj)\n        for (let k in obj) {\n            let v = obj[k];\n            let type = typeof v;\n            if (/string|undefined|function/.test(type)) {\n                v = '\"' + v + '\"';\n            } else if (type === \"object\") {\n                v = jsonStringify(v);\n            }\n            json.push((arr ? \"\" : '\"' + k + '\":') + String(v));\n        }\n        return (arr ? \"[\" : \"{\") + String(json) + (arr ? \"]\" : \"}\")\n    }\n}\njsonStringify({x : 5}) // \"{\"x\":5}\"\njsonStringify([1, \"false\", false]) // \"[1,\"false\",false]\"\njsonStringify({b: undefined}) // \"{\"b\":\"undefined\"}\"\n```\n\n#### ç¬¬äºŒé¢˜\n> å®ç°ä¸€ä¸ªJSON.parse\n\n```js\nJSON.parse(text[, reviver])\n```\n\n```js\n// eval\nfunction jsonParse(opt) {\n    return eval('(' + opt + ')');\n}\njsonParse(jsonStringify({x : 5}))\n// Object { x: 5}\n\n// new Function\nvar jsonStr = '{ \"age\": 20, \"name\": \"jack\" }'\nvar json = (new Function('return ' + jsonStr))();\n```\n\n- [ã€ŠJSON.parse ä¸‰ç§å®ç°æ–¹å¼ã€‹](https://github.com/youngwind/blog/issues/115)","tags":[],"folderPathname":"/weekly","data":{},"createdAt":"2021-05-13T15:41:35.531Z","updatedAt":"2021-05-18T02:19:07.427Z","trashed":false,"_rev":"RTYjMf68g"}