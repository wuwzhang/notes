{"_id":"note:Ol40jYnqX","title":"概念","content":"## BFF层\n> 为前端而存在的后端(服务)中间层，前端走向云端，划分职责边界，提升协作效率\n\n![](image-krd3xzi0.png)\n### 作用\n> 处理前端技术接口请求→调用后端接口，进行数据聚合→响应前端，渲染页面\n\n用户体验适配层和 API 聚合层\n\n- 接口聚合和透传\n  - 服务于不同的端（app/小程序/web）\n  - 字段裁剪\n  - 接口合并调用\n  - 接口数据格式化\n- 缓存聚合调用的结果\n- 提供第三方使用的API\n- 服务自治（谁开发谁使用），减少协调成本\n\n### 适用场景\n> 要满足一定的场景并且基建很完善的情况下才使用，否则只会增加项目维护成本和风险，收益却非常小\n\n- 后端有稳定的领域服务，需要聚合层\n- 需求变化频繁，接口经常需要变动：后端有一套稳定的领域服务为多个项目服务，变动的话成本较高，而bff层针对单一的项目，在bff层变动可以实现最小成本的改动。\n- 有完善的基建：日志，链路，服务器监控，性能监控等（必备条件）\n\n### 探索方向\n- 稳定性：保障BFF的可靠性，如通过日志、错误分析、监控、报警等手段\n- 同构：让BFF与前端体验使用相同的技术栈，如基于Node的同构方案\n- 一体化：一方面针对下游服务提供mock方案，另一方面允许同构、非同构应用共存\n\n### Node.js能胜任吗\n#### 应用分布\n- 函数模型 70% （BFF属于这类）\n  - 快速开发、领域模型到UI模型的转换\n- 全站应用 20%\n  - 应用型应用（如语雀）\n- Task 异步任务 10%\n  - 覆盖高CPU/MEM、执行周期长（如构建任务、爬虫）\n\n#### 结论\n- Node.js 是完备的，足够胜任 BFF 的主要应用场景\n- BFF 要求服务自治，但不限制技术选型\n  - 选择生态最活跃，最能被前端接受的 Node.js\n- 我们缺的是沉淀\n  - 基础设施的建设和完善\n  - 最佳实践的沉淀和积累\n  - 人员平均水平的提升\n\n### 沉淀\n- 框架\n- 中间件，融入后端生态\n  - 分布式配置\n  - 缓存\n  - 限流\n  - 熔断\n- 平台能力\n  - 问题定位\n  - 包管理\n  - 研发管控平台\n  - 应用治理\n- BaaS 服务\n  - 常用能力下沉（如：渲染服务、消息服务、文件服务、构建服务）\n\n### 问题\n- 学习成本\n  - 额外的服务端、运维相关知识的学习成本\n- 治理成本\n  - 依赖升级，锁版本，中间件服务跨语言 SDK 的维护\n- 招人难\n  - 前端涉及领域多，人员储备不够，培养成本高\n- 资源利用率\n  - BFF 通常的水位较低（<30%）\n","tags":[],"folderPathname":"/end/bff","data":{},"createdAt":"2021-07-21T03:18:56.372Z","updatedAt":"2021-07-26T04:06:43.681Z","trashed":false,"_rev":"iZ5XlpoP6"}