{"_id":"note:fl-KcCnVJ","title":"动效-0","content":"## 动效 - 理论\n\n### 目的\n用户体验设计的发展日趋完善，优秀的动效是完善用户体验中不可或缺的一环，优秀的界面动态设计可以让产品的用户体验锦上添花……\n\n道理我都懂，但是动效做起来真的很麻烦，而且存在许多的问题，比如：\n![](http://image.woshipm.com/wp-files/2018/04/MbG7YpgOk3FzNYGnBwna.jpg)\n\n1. get不到设计师想表达的“具体”意思（接近代码），毕竟同样的一套动效，在设计工具上和`Web`端上实现逻辑可能完全不一样，在开发和设计之间，还没有一套成熟的对接标准，没有精确的参数描述，做起来也很痛苦，导致最终开发效率低下\n2. 界定什么才是好的动效\n3. 没有良好的技术储备，高保真高效率的完成动效，界面增加了时间维度，研发不仅仅需要布局，同样要把控各个元素在时间流上的表现，个别情况下使用序列帧或者 Gif 的话，又需要严格控制资源大小，在各方面增加了开发的成本\n\n在web应用开发中，使用动效来增加用户操作的舒适度，或者引导用户关注重要的信息是很常见的需求。但程序员对于动效需求的态度却是矛盾的。一方面，设计师和程序员缺少交流的语言，在拆分动效参数的时候，双方只能摸着对方过河，交流成本很高；另一方面，还原时需要兼顾到开发的时间成本，设备性能和兼容等问题，如果选择的方案不对，开发成本都会成倍增加。\n\n---\n\n### 什么样的动效是好动效\n动效并不是为了炫技设计出来的东西，它是有很多现实意义的。他需要满足以下几点:\n\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-19.jpg)\n\n#### 1. 满足用户的心理预期\n我们生活在一个物理世界，任何事物的运动都是符合物理世界的客观规律的。\n\n因此，人对于事物的观察和理解都是出于对物理规律的理解。\n\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-17.jpg)\n\n通过合理的动效，让虚拟界面模拟物理世界的规律，例如惯性、视差等等，可以让这个虚拟的世界与物理世界产生交集。用户会把自己对物理世界的认知映射到对产品的认知上。\n\n##### 质量\n\n物体都拥有质量，质量带来了我们最常见的物理现象：惯性。在这个例子中、方块在界面上通过加速、减速、反弹、过冲等等动态来模拟所谓的重量感，让这个简单的界面元素有了实在感。\n\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-14.gif)\n\n##### 空间\n\n我们所处的世界是三维的，然而受显示设备的影响，目前大家接触的大部分人机界面还是二维的，如何通过一个二维平面来模拟三维的世界呢？\n\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-3.gif)\n\n这个例子中，近处的方块运动的快，远处的方块运动的远。通过这样的视差的效果，整个屏幕有纵深感，不再是一个简单的二维平面。我们很容易感受到，方块间的层叠顺序。同理，类似简单的动效，可以很轻易的表达元素的层级。\n\n\n#### 2. 引导用户注意力\n如果把一个界面上的所有元素，按照明显程度来排序，显而易见我们会得到这样一个顺序：动态 > 色彩 > 明度。\n\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-4.gif)\n\n所以通过合理的动效，可以低成本的抓取人的注意力，让他们关注设计师想让他们关注的东西。\n\n网易新闻的刷新动画，就是一个很优秀的例子：\n\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-5.gif)\n\n在这个例子中，左上角有一个非常简单的白色线状`icon`，并不会干扰整个页面的主功能，颜色，以及视觉。但是通过小的动画，提升了`icon`的视觉层级。让我们很容易注意到它，起到了非常好的提示效果\n\n#### 3. 情感化设计\n\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-18.jpg)\n\n情感话设计的目标是在用户接触和使用产品的过程中，激发用户的正向情感，比如愉快，信任，满足；避免用户产生负向情感，比如失望，挫折感，痛苦。正向的情感会使用户更乐于使用产品，遇到使用过程的一些小问题也更加包容。\n\n而优良的界面动效可以打磨产品的品质感，下面就是动效在情感化设计中的优秀例子：\n\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-6.gif)\n\n`twitter`点赞后，心会亮起的同时，还有一个小小的礼花效果。虽然完全没必要加上这个礼花效果，但是这种丰富的细节会让用户对产品产生一个正向的情感关联，而这种关联最终将赢得用户对产品的认同。\n\n`Facebook`点赞之后，可以表达你的态度，比如流泪，愤怒或者是赞。虽然在功能上来说，这些表情有静态的就可以了。但是正是动画中丰富的表情细节，进一步引导用户愿意去表态。不仅给人以惊喜，也显著的提升表态的使用量。\n\n动效的价值就讲到这里，接下来，基于以上三点，我会说一说怎样去构建一个合理高效的动效体系。\n\n### 二、优秀的界面动效体系\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-20.jpg)\n\n优秀的界面动效体系符合以下四点原则：\n- 通过动效暗示二维界面暗含的三维层级关系，及其暗含的操作逻辑。\n- 引导用户的注意力向界面重点元素。\n- 通过动态设计让情感化设计变得更生动。\n- 动效的视觉效果统一，控制数量，不滥用。\n\n接下来用`iOS`系统动效来举例子，众所周知`iOS`的动效系统经过了多次的迭代，已经做的非常完美，而上述四点，在接下来的例子中都有体现。\n\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-8.gif)\n\n#### 1. 层级暗示\n\n切换界面的时候，所有打开的`APP`界面覆盖在刚才的主界面上面，同时主界面模糊，内容区域的缩小，共同营造出原来界面往深处后退的效果。很直观的表达了主界面和`APP`界面的层级关系。\n\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-9.gif)\n\n在键盘机的时代，通过菜单进入一个新页面的时候，通常做法是整个页面刷新一下，但是这样操作久了，打开菜单太多，很容易让人有一种「迷路」的困惑。在这个动画中，通过界面的左滑、右滑来表达不同界面之间的层级关系。即使看不到主菜单，你也知道自己是从哪儿进来的。\n\n#### 2. 操作暗示\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-10.gif)\n\n在这个例子中，长按一个 图标进入编辑模式，所有图标都会开始晃动。虽然整个页面并没有任何文字提示说明「现在图标可以拖动的」，但是这种抖动的不稳定感很直观的表达了设计者的意图。\n\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-11.gif)\n\n当输入密码错误的时候，密码输入栏会显示出一个摇头的效果。完全可以想象，假设用一个错误提示的弹窗，不仅会中断用户的操作流程，引起人的反感，而且很容易让人受挫。通过动效，设计者用一种更友好简单的方式达到了提示的目的。\n\n#### 3. 趣味\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-16.gif)\n\n这里是开关状态的过度，我们可以看到月亮会有盈亏，锁的状态有锁上和开启两种。这些有趣味的细节动效给用户带来惊喜，提升界面的品质。\n\n#### 4. 克制\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-12.gif)\n\n举了那么多正面例子，下面也说两个反例。这两张图都是我在 dribbble 找到的点赞量非常高的图。但是实际上，完全不推荐在产品中使用这样的效果。\n\n动效不能滥用，要控制数量。在这页面中，所有东西都在动。很难让人抓住视觉重心。当菜单栏下滑的时候，每一个菜单都会有一个抖动的效果。我们并不知道这个菜单为什么要这样颤，看起来作者只是为了炫技这么做，实际上并没有传达任何的内容，还会无形的增加了用户的操作负担。\n\n![](https://image.uisdc.com/wp-content/uploads/2018/04/uisdc-dx-20180403-13.gif)\n\n好的动效要控制在0.3~0.5秒，本例中，菜单出现几乎花费了一秒。频繁打开菜单很容易引起人的疲倦，可以说是画蛇添足了。\n\n---\n\n### 对接\n开发和设计师沟通困难。是因为没有通过精准的参数去描述动效。要解决这个问题，我们需要创造一套有效的动效标注系统，这个系统必须做到以下两点：让设计师可以轻松地描述动效，让开发可以准确地还原动效。构建这套『标注』的方法分以下两个部分阐述：\n\n#### 动效量化\n其实，界面动效背后涉及到的设计参数非常简单，只有三种。无论多复杂的动效也是这三种参数经过组合拼接出来的：\n\n![](http://image.woshipm.com/wp-files/2018/04/kg2UzN9ejDBRMGRITzSC.jpg)\n\n##### 1. 变化\n\n变化可以划分为四类（如动图所示），这四类变化基本涵盖了界面元素的全部运动方式，只要我们准确地描述元素在动效前后的变化量，就可以准确地完成「变化」这个参数的对接。\n\n![](http://image.woshipm.com/wp-files/2018/04/adzf2L3mpfZwQ1Vo9tWE.gif)\n\n举个例子，下面动图中被扔出来的绿色小恐龙就同时包含上述四种变化。\n\n![](http://image.woshipm.com/wp-files/2018/04/rZ91d2Y38UlrIUZhxRNi.gif)\n\n它在`AE`中前后变化的参数如下：\n\n![](http://image.woshipm.com/wp-files/2018/04/QD4MUbgWTV736kmdQ9Ta.jpg)\n\n那么这个时候我们需要记录的状态（这里只涉及到变化）就应该是这样：\n\n- 初始状态：\n  - 位移：X轴 0\n  - 旋转 ：0度\n  - 尺寸：1\n  - 透明度：0.2\n- 结束状态：\n  - 位移：X轴 200px\n  - 旋转：+180度\n  - 尺寸：1.5\n  - 透明度：1\n\n这样看就清晰多啦。作为一名友善的设计师、千万不要随便拿一个 demo 说『就按照这样做个差不多的效果就可以了』、那样的话估计大部分开发只会一脸懵逼。\n\n##### 2. 时长\n\n第二个关键参数就是时长，这个顾名思义也就是动画播放的时间长度。无论变化是多是少，简单还是复杂，我们需要把每一段变化的时间确定，时间短干脆利落，时间长轻缓柔和。\n\n在标注的时候，不要忘记标注清楚动效的起始时间和终止时间。\n![](http://image.woshipm.com/wp-files/2018/04/tZIFLjdB09KNKlkWMY3f.gif)\n\n##### 3. 曲线\n\n曲线描述的是物体运动时候的速度变化，如果说变化和时长是动效的本体，那么曲线就是动效的灵魂。\n\n对于一个运动的物体，同样的变化，同样时间，赋予不同的速度曲线，会让它的动效产生丰富的变化。 所以在动效设计中，曲线也是设计者最为关注的部分。\n\n最基础的速度曲线有线性（就是全程匀速）、缓入、缓出、缓入缓出四种：\n\n![](http://image.woshipm.com/wp-files/2018/04/ePEVzNAmM6J1h1n15Z8W.jpg)\n\n虽然大家平时或多或少都用过以上几种曲线来描述动画的过程，但是大家不一定对曲线的具体用法有真正的理解、下面我会给出四个例子，来阐述一下以上几种曲线的用法。\n\n在上图的例子中小圆运动时长一致，它们水平位移、一起到达终点，但是速度曲线不一样。\n\n![](http://image.woshipm.com/wp-files/2018/04/g4C14yU7dA4qSVPwVEy5.gif)\n\n- 圆一：缓出 ease-out、本来有一定的速度、慢慢刹车。 适合用在一个元素进入页面的时候。\n- 圆二：缓入 ease-in、本来没速度，越来越快， 相当于一个东西从零开始加速。适合用在一个元素离开页面的时候。\n- 圆三：缓入缓出 ease-in-out：开头结尾都没有速度，先加速、再减速。是我们日常生活中最常见的物理运动。适合用在一个元素从页面 A 点到 B 点。\n- 圆四：做匀速运动 linear 、看起来非常死板，不推荐使用。\n\n那么，动画曲线在设计工具的哪里出现呢？\n\n![](http://image.woshipm.com/wp-files/2018/04/3BaoEFCKqrS8IwqCZ4pY.jpg)\n\nAE 中可以通过值图表，来调整动画的曲线，并且通过换算（换算方法）得到可用于开发的 cubic-bezier 曲线参数，或者通过 Flow 这样的插件直接用 cubic-bezier 曲线进行设计。\n\n而在新兴设计工具（Framer）中，本身工具就直接可以用 cubic-bezier 曲线定义动画。\n\n在前端开发中，可以直接利用设计给出的 cubic-bezier 曲线参数来描述动画，示例如下：\n\n![](http://image.woshipm.com/wp-files/2018/04/86c9KzohBcq1viqjITC5.png)\n\n现在有许多工具可以方便设计师去调曲线、实时预览效果、并且显示成前端需要的格式。在这里推荐两个：\n\ncubic-bezier.com\n![](http://image.woshipm.com/wp-files/2018/04/xafTmw8JvO8bnLLXHbAK.jpg)\n\n曲线部分就这样讲完了，顺带提一下，虽然在这里我举例的是位移的速度曲线、但是其实旋转、尺寸、透明度等等变化同样是存在速度曲线的~ 在这些变化上加上速度曲线一样可以让动效更加自然贴近真实。前端也是可以实现的哦。\n\n通过以上对动效参数的量化、我认为一份合格的标注应该是这样的：\n\n![](http://image.woshipm.com/wp-files/2018/04/6bMOd5eNkwO9XzzUJQw5.gif)\n\n上图中的交互动效来自Amazon Prime Music、界面中出现了两个元素（加号 icon & 对勾 icon）的动画，虽然看起来非常简单、但是包含着极为丰富的变化。\n\n标注的时候除了说明动效的三元素、还要说明触发条件以及动画对象、所以最好用表格的方式、这样可以更清晰的把它们每一段变化都清晰罗列出来：\n\n![](http://image.woshipm.com/wp-files/2018/04/vFN6kvXYp8WrjJlFqc6P.jpg)\n\n如图，注意曲线要标注好英文名称这样前端才可以拿去用\n\n希望可以帮助你 ：）\n\n如果看到这里你还有许多疑问、推荐阅读 MartinRGB 写的[MartinRGB/MTGuideline](https://github.com/MartinRGB/MTGuideline/wiki/1.0-Motion-Design-%E8%A7%84%E8%8C%83%E7%BB%BC%E8%BF%B0)、里面从交互动画的风格定义、到动效设计 － 标注 － 开发流程 都有介绍~\n\n#### 设计方法与工具\n最传统普遍应用的动效设计工具是 After Effects，因为可能很多设计师在之前就有使用的经验，但它也有不符合当下需求的缺点：不能交互、产出物不好量化、难分享。而目前也出现了很多新兴的设计 – 产出解决方案，下面我会做一些简单的介绍。\n\n##### 自动导出类\n\n![](http://image.woshipm.com/wp-files/2018/04/X6d97zn4bVWeu4BwluyS.jpg)\n\n目前，有像[Lottie](http://airbnb.io/lottie/#/)(对于Android, iOS, Web, React Native均支持，亲测有效)、[Keyframes](https://github.com/facebookarchive/Keyframes)等开源库，通过 AE 插件，将在 AE 中设计的动效自动导出为 前端可用的动效文件，前端只需要在项目中打入对应的开源库，就可以免去对接交流的苦恼。\n\n虽然看上去十分简洁美好，但是这种方案的应用场景是有限的：仅适合应用在纯动效元素（例如动态 ICON），无法用于 UI 的界面元素。对 AE 的效果支持也有限，并不是有了库就能为所欲为。\n\n但总的来说，自动导出类方案可以在纯动态元素的场景下大大提升工作效率，产品性能。相比 Gif 或者帧序列，导出的 json 文件容量小，在端上显示质量高。\n\n##### 可交互类\n![](http://image.woshipm.com/wp-files/2018/04/kYX1cFnTsik8YrhrSD2P.jpg)\n\n除了依赖于 AE 传统工具的解决方案，也有更多直接另起炉灶的设计工具。目前应用较广的包括 Principle、Flinto、Framer、Origami 等等。相比传统工具，这些新的工具无一例外加入了可交互的特性，让我们可以对产品的交互流进行设计和模拟。比起之前，我们可以在设计阶段就感受产品的「手感」，让动效设计的精度到达一个新的水平。\n\n在这些雨后春笋般冒出的新工具中，我最喜欢的就是 Framer--它有着其他工具没有的独特属性——用代码构建、基于 Web。\n\n![](http://image.woshipm.com/wp-files/2018/04/u16JhAJe6c5Lw8HwV5oP.jpg)\n\n可能很多设计师看到代码就如临大敌，但事实上，因为用代码构建，设计师们可以十分有条理、清晰地设计拥有复杂逻辑的动效界面，同时，动画部分的代码内容可以直接给开发参考。另外因为基于 Web 的特性，所有 Web 支持的效果，Framer 都可以做到，自由度极高，而且设计产出可以通过一个网址快速分享，让整条产品线上的人都可以低成本体验你的动效设计。\n\n除此之外，在「全栈」概念越来越被重视的今天，设计师通过一个相对低成本的方式接触代码，了解前端知识，是一个非常高效的提升通道。\n\nFramer 的上手资料推荐 Melodie 的知乎回答：Melodie：Framer（framerjs.com）如何入门？ 是目前来说比较易懂的入门 Framer 的文章。\n\n#### 开发\n\n Animate.css\n \n \n #### 3、序列帧\n序列帧可以理解为跑马灯、具体实现方式是提供一张动画的帧序列拼图、通过 CSS 和 JS 控制它逐帧播放。跟交互动效不太一样、序列帧动画一般用在运营页面的动画里。举个例子、之前的春节活动里、我曾经做过一个序列帧动画。如下动图所示：\n\n![](http://image.woshipm.com/wp-files/2018/04/ad755AGo37CeyKM8avBK.gif)\n\n它其实是用一张张的烟花图拼接起来的雪碧图：\n\n![](http://image.woshipm.com/wp-files/2018/04/KIispfeUykfdZynBtuJZ.jpg)\n\n为保证动效的最佳用户体验，使用序列帧也有许多要求\n\n- 加载时间：最低网速环境下加载超过2s必须加loading。loading加载时长不超过5s；\n- 移动端流量消耗：移动端非wifi网络下，动画资源限制总大小不超过2M。\n\n通常用户感知流畅帧率为60fps、为了保证最终效果、一般以20fps做为最低播放帧率。（1S播放30帧 ）\n\n当然、为了减少沟通中不必要的损耗、在提供序列帧拼图的时候、要注意以下交付格式\n\n- 提供每帧图的宽高尺寸\n- 每帧图的播放时长，总帧数\n- 动效Demo，gif、MP4等，格式不限\n- 动画触发时机，如：页面加载结束时，某按钮点击时\n\n补充一个制作序列帧的工具[gka](https://gka.js.org/#/)\n\n\n### 其实可以把『锅』扔给设计师\n大多数前端开发者在设计和动效方面并没有太多积累，因而难以做出令人拍手称赞的效果。其实，这是设计师（或动效设计师）所擅长的领域，可从下表查看两者的对比：\n\n|-|设计师|前端开发|备注|\n|--|--|--|--|\n|是否擅长动画|大部分|少部分|\n|如何生产动画|GUI 工具，如 AE|编写代码|\t\n|效益|高|低|体现在以下几个方面：<br> 1. 专业度<br> 2. 实现效率：可视化 > 编写代码<br> 3. 沟通成本<br> 4. 各方满意度<br> 5. ...\n\n从上表可得，将『动效设计』交给设计师能显著提高效益。从实际工作流程上说：\n\n设计师与前端开发的排期由『线性』变为『部分重叠』：设计师交付静态视觉稿后，前端开发就能进行视觉还原，设计师此时即可进入动效设计。\n\n设计师将动效设计导出为视频，提前取得各方满意度，避免开发期间的反复沟通修改。\n假设达成以上共识后，剩下的问题就是：如何还原`<a name=\"apple\"></a>`『动效稿』？\n\n|![](http://storage.360buyimg.com/mtd/home/ae2web-31560770181612.gif)|![](http://storage.360buyimg.com/mtd/home/ae2webezgif-com-optimize1560770283267.gif)|\n|--|--|\n|补间动画——Apple|逐帧动画——洗衣机|\n\n其实，与『制造业』一样，实现方式就两种：\n\n1. 机械：通过工具直接导出\n2. 手工：手动取参数，通过掌握的 Web 技术实现\n\n两者的优缺点比较：\n\n|\t|机械\t|手工|\n|--|--|--|\n|效率|高|低|\n|精度|高|视情况而定|\n|定制化|低|高|\n|情怀|无|因人而异|\n\n机械实现\n机械代表着“未来、高效”。业界出现了很多优秀的工具，使得在浏览器渲染复杂动效成为了可能，且极大地提高了效率。\n\n代表工具有：\n\n- [Bodymovin](https://exchange.adobe.com/creativecloud.details.12557.html#.WpunqpNuZmM)是 AE 的一个插件，用于将 AE 导出为 Web 动画（HTML、SVG 或 Canvas），仅支持 AE 部分特性。\n- lottie-web 是 Airbnb 团队的一个用于在 Web、Android、iOS 和 React Native 渲染 AE 动画的库。\n\n可是『世界上本来就没有十全十美的东西』。机械化生产可能未必满足所有要求，生产环境上的要求就更加苛刻了。主要体现在：机械化生产导致介入难度高。若出现以下问题就难以解决：\n\n1. 兼容性\n2. 在动画过程中插入自定义逻辑\n3. 工具自身的不完善\n4. 文件体积要求\n5. ...\n\n无论如何，『机械化』是未来，期待它以完美的姿态到来。\n\n#### 手工实现\n手工代表着“自定义、可控性”。无论世界如何工具化，总有一些人保持着对『手工』的热情。\n\n『手工』意味着从无到有的过程。需要我们参与这个过程的每一步。这也就使得我们拥有了很强的自定义能力。这恰恰是『机械化』目前所不具备的特性。这也是本文重点阐述的内容。\n\n基于 AE 手工实现 Web 动画的主要工作有两个：\n\n1. 在动效稿上拿到元素的参数信息，如 x/y/z、rotation 等\n2. 通过适当的 Web 技术进行实现，如 CSS3/Canvas/SVG 等\n\n##### 如何手工取参\nWeb 动画一般分为 逐帧动画 和 补间动画 。\n\n显然，对于取参操作来说，逐帧动画比补间动画的工作量要大得多，但两者操作一致。所以下面以 补间动画 Apple 为例：\n\n打开 apple.aep 文件，AE 界面如下：\n\nWeb 动画一般分为 逐帧动画 和 补间动画 。\n\n显然，对于取参操作来说，逐帧动画比补间动画的工作量要大得多，但两者操作一致。所以下面以 补间动画 Apple 为例：\n\n打开 apple.aep 文件，AE 界面如下：\n\n![](https://misc.aotu.io/JChehe/2018-03-06-ae2web/ae_gui.png)\n\n###### AE 界面\n\n> 点击『信息模块』预览面板的播放按钮或拖动『时间轴模块』的 标记3 即可预览动画。\n\n根据 CSS3 animation 属性，我们需要获取以下信息：\n\n1. 动画持续时间 animation-duration\n2. 关键帧之间的缓动函数 animation-timing-function\n3. 动画延时时间 animation-delay\n\n> 为了方便阐述，我们选取整个 Apple 动画中一个小圆圈（共 60 个）为代表，其余元素同理。 另外，由于该动画是一次性的，无需设置/获取动画的重复次数（animation-iteration-count）、运动方向（animation-direction）。\n\n现在我们把目光投向『图层、运动模块』的 标记1：\n\n![](https://misc.aotu.io/JChehe/2018-03-06-ae2web/fps.png)\n\n标记1——FPS\n\n由上图可得，FPS 为 12，即 1 秒 12 帧， 1 帧 0.0833 秒。\n\n由上面 Apple 动画 可看出，每个圆的延时时间（animation-delay）、缓动函数（animation-timing-function）和持续时间（animation-duration）均不相同。换句话说，每个圈都是一个独立的补间动画，所有元素组合起来才是一个完整的补间动画。\n\n双击『标记 2』，进入编组以查看每个圆的信息。\n\n![](https://misc.aotu.io/JChehe/2018-03-06-ae2web/ae-keyframes.png)\n\n子元素——圆\n\n在『查看器』或『图层、运动模块』任意选中一个圆，展开其 变换 属性并单击 位置（标记1），即可显示右侧的元素运动路径（标记2）。同时这也反映了属性的变化速率（即缓动函数（animation-timing-function），这方面会在后面详解。\n\n> 位置 前面的时钟图标为蓝色时，代表有过渡动画。\n\n某个圆的时间轴\n\n结合上面知识，可从上图得出以下信息点：\n\n1. 该元素共有 4 个关键帧\n2. 只有 Y 轴上发生位移运动（绿线），X 轴上则是静止状态（红线）\n3. 延时时间为 1 帧\n4. 中间停留时间（第2、3 关键帧之间）为 1 帧\n5. 过渡时间为 42 帧（3 * 12 + 7 - 1）。注意要减去延时时间（1），因为 02:03 包含了它。下同。\n\n因此，我们基于 CSS3 animation 实现该元素的补间动画：\n![](image-kp6lcpuw.png)\n\n```html\n<div class=\"circle-29\"></div>\n```\n\n```scss\n/* 默认定位在第2（或3）帧以让元素默认显示屏幕内，便于开发调试。 */\n.circle-29 {\n    width: 60px;\n    height: 60px;\n    background-color: rgba(0, 224, 93, .7);\n    position: absolute;\n    left: 473px;\n    top: 348px;\n    border-radius: 50%;\n    animation-name: circle29;\n    animation-duration: 3.5s; /* 42 * (1 / 12) */\n    animation-delay: 0.0833s; /* 1 * (1 / 12) */\n    animation-fill-mode: both;\n    animation-timing-function: ease-in-out;\n}\n\n@keyframes circle29 {\n    0% {\n        transform: translate3d(0, 1175px, 0);\n    }\n    61.90% { /* (2 * 12 + 3 - 1) / 42，注意要减去延时时间（1），因为 02:03 包含了它。下同。*/\n        transform: translate3d(0, 0, 0);\n    }\n    64.29% {\n        transform: translate3d(0, 0, 0);\n    }\n    100% {\n        transform: translate3d(0, -1225px, 0);\n    }\n}\n```\n\n其余元素按照以上步骤执行即可完成整个动画。\n\n假设没有动画演示和动效稿，仅凭借着个人感觉，编码完成一个由 60 多个元素组成的动画，简直难于上青天（对于笔者来说）。\n\n也许你对 animation-timing-function 存在误解\n细心的读者可能发现：如果第 1、2 帧和第 3、4 帧的缓动函数不相同时，该怎么办？\n\n首先部分人可能对 animation-timing-function 存在误解：它是作用于整个 @keyframes 规则的。❌\n\n![](https://misc.aotu.io/JChehe/2018-03-06-ae2web/timing-function-error.png)\n\n其实缓动函数是作用于 @keyframes 规则内的关键帧。若未为关键帧指定 animation-timing-function，则会从其元素取得 animation-timing-function。\n\n更严格地说，缓动函数是应用在属性上，从定义该属性的关键帧到下一个指定同样属性的关键帧。若后续无指定该属性的关键帧则到动画结束。因此，在 100% 或 to 关键帧上指定 animation-timing-function 是无用的。\n\n举个例子：\n\n![](image-kp6ld674.png)\n\n```scss\n.box {\n    width: 100px;\n    height: 100px;\n    background-color: #6190e8;\n    animation: move 2s ease both;\n}\n\n@keyframes move {\n    0% {\n        animation-timing-function: linear;\n        transform: translateX(0);\n        opacity: 1;\n    }\n    50% {\n        opacity: .5;\n    }\n    100% {\n        transform: translateX(100px);\n        opacity: 1\n        animation-timing-function: ease-in-out; /* 无用多余 */\n    }\n}\n```\n\n在 0% 关键帧中指定的 animation-timing-function: linear 是对 transform 和 opacity 属性有效。但因为 50% 关键帧未指定 transform 属性，所以 animation-timing-function: linear 对它生效至有指定 transform 属性的关键帧，即 100%。\n\n另外，由于 50% 关键帧未指定 animation-timing-function，所以它会使用 .box 元素上指定的 ease 缓动函数。\n\n总上所述，可在关键帧上指定不同的缓动函数，以满足关键帧间属性的不同变化速率。\n\n##### 更强大的 cubic-bezier\n细心的读者可能又发现：缓动函数碰巧是 预定义的关键字 ，如果是以下这种情况呢？\n\n![](https://misc.aotu.io/JChehe/2018-03-06-ae2web/complicated-timing-function.png)\n\n显然浏览器预定义的关键字无法表示该类型的缓动函数，但浏览器提供了强大的 cubic-bezier() 方法。翻译过来就是三次贝塞尔曲线。因此，我们可以通过该方法自定义缓动函数。\n\n> 想了解贝塞尔曲线的更多知识，可阅读[《贝塞尔曲线扫盲》](http://www.html-js.com/article/1628) 。\n\nAE 时间轴上呈现的是属性的变化路径，其未必与变化速率（即缓动函数）完全一致。因为它们的 X/Y 轴含义不同。\n\n![](https://misc.aotu.io/JChehe/2018-03-06-ae2web/ae2css.png)\n\n如上图所示，AE 是属性随着时间而变，CSS3 animation 是动画进度随着时间而变。然而属性的变化是有方向的，动画进度是永远向前的。\n\n举个例子：\n\nAE：\n\n![](https://misc.aotu.io/JChehe/2018-03-06-ae2web/ae-timing.png)\n\nAE 属性变化是有方向的\n\n对应 CSS3 animation-timing-function：\n\n![](https://misc.aotu.io/JChehe/2018-03-06-ae2web/css-timing.png)\n\n动画进度永远是向前的\n\n如上面二图所示，下图是上图的速率变化（缓动函数）。理清 AE 与 CSS3 animation 的对应关系后，剩下的问题就是：如何通过 cubic-bezier() 表示图中的 CurveA 与 CurveB。\n\n也许有工具可从 AE 直接导出（欢迎读者们提供链接），但本文为了简单起见，推荐使用 Ceasar 或 Cubic-Bezier.com 这类可视化工具直接模拟生成。\n\n因此，上述补间动画的缓动函数可表示为：\n\n```scss\n@keyframes ae2css {\n    0% {\n        animation-timing-function: ease-out;\n    }\n    23% {\n        animation-timing-function: ease-in;\n    }\n    50% {\n        animation-timing-function: cubic-bezier(0.5, 0, 0.5, 1.5);\n    }\n    76% {\n        animation-timing-function: cubic-bezier(0, 0, 0, 1);\n    }\n    100% {\n    }\n}\n```\n\n","tags":[],"folderPathname":"/font/css","data":{"bookmarked":true},"createdAt":"2021-05-23T12:27:59.568Z","updatedAt":"2021-05-27T07:45:26.911Z","trashed":false,"_rev":"pck-eMcIE"}