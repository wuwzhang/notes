{"title":"第2期","content":"\n# 2021/01/07\n\n## 每日资讯\n### 1. `React Query 3`：获取、缓存和更新数据的`Hooks`\n> 它可以帮助你缓存服务器状态，并且将缓存状态与全局状态分离，另外还允许你异步读取和更新所有状态; 常被形容`React`缺少的数据库\n\n#### 请求处理\n##### 通过`useQuery`、`useMutation`等`API`进行数据请求、处理\n- 简单请求\n```jsx\nconst List = () => {\n  // 第一个参数为唯一键（query key）\n  const { data, isLoading, isError } = useQuery(\"list\"， fetchList)\n  \n  f (isLoading) {\n     return <span>Loading...</span>\n   }\n \n   if (isError) {\n     return <span>Error: {error.message}</span>\n   }\n \n   return (\n     <ul>\n       {data.map(item => (\n         <li key={todo.id}>{todo.value}</li>\n       ))}\n     </ul>\n   )\n}\n```\n**支持分页查询（`usePaginatedQuery`）、滚动加载(`useInfiniteQuery`)**\n\n- 操作\n```jsx\nconst Modify = () => {\n   const [mutate] = useMutation(updateFn)\n \n   const onSubmit = async () => {\n     await mutate({}, {\n       onSuccess: () => {},\n       onError: () => {}\n     })\n   }\n   \n   return <button onClick={onSubmit}>sumbit</button>\n }\n\n```\n#### 全局服务端状态管理\n将所有的服务端状态维护在全局，支持数据自动缓存、重新获取数据、取消请求等功能(`React Query`会维护一棵服务状态树，通过唯一键`query key`判断是否存在，存在则直接返回，否则发起请求)\n\n提供`queryCache.invalidateQueries`实现某个`query key`的缓存失效，达到重新渲染的效果\n\n##### 其他\n- 支持REST, GraphQL, promise等\n- 支持专用`Devtool`\n- 支持自动缓存、重新拉取数据\n- 支持请求取消\n\n\n#### 相关文章\n- [github](https://react-query.tanstack.com/)\n- [用 React Query 来管理数据请求](https://zhuanlan.zhihu.com/p/261146977?utm_source=wechat_session)\n- [为什么我停止使用Redux](https://dev.to/g_abud/why-i-quit-redux-1knl)\n\n## 每日一问\n\n> 以下代码的运行结果是？\n\n```js\nconst a1 = ['a', 'b', 'c']\nconst a2 = ['b', 'a', 'c']\n\nconsole.log(\n  a1.sort() === a1,\n  a2.sort() === a2,\n  a1.sort() === a2.sort()\n)\n```\n\n- A &nbsp;&nbsp;[true, true, ture]\n- B &nbsp;&nbsp;[true, false, true]\n- C &nbsp;&nbsp;[true, true, false]\n- D &nbsp;&nbsp;[false, true, true]\n\n### 昨天的答案\n- A\n- `new Array()`创建空白数组，`map`不会变量空白数组\n","tags":[],"folderPathname":"/weekly","data":{},"createdAt":"2021-02-22T06:55:28.265Z","updatedAt":"2021-02-23T01:50:40.807Z","trashed":false,"_id":"note:EfIUStf2F","_rev":"10-7dd8b7351d2ca9b0def349d2d507dd1d"}